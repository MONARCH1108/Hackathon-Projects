# 🛡️ OWASP AI Vulnerability Scanner

AI-powered OWASP Top 10 vulnerability scanner using Ollama and LLaMA for automated code and web security analysis with Flask interface.

### Documentation: 
https://medium.com/@abhayemani8/owasp-ai-vulnerability-scanner-%EF%B8%8F-9aa3bd5da7ba

## 🌟 Features

- **AI-Powered Analysis**: Uses LLaMA 3.2 model via Ollama for intelligent vulnerability detection
- **OWASP Top 10 Coverage**: Comprehensive analysis covering all OWASP Top 10 2021 categories
- **Dual Input Methods**: Analyze source code directly or fetch content from URLs
- **Risk Assessment**: Categorizes vulnerabilities by severity (Critical, High, Medium, Low)
- **Interactive Web Interface**: Modern, responsive UI with real-time analysis
- **Detailed Reports**: Provides vulnerability descriptions and remediation suggestions
- **RESTful API**: JSON API endpoints for integration with other tools

## 🚀 Quick Start

### Prerequisites

1. **Install Ollama**
    
    ```bash
    # Visit https://ollama.ai/ for installation instructions
    curl -fsSL https://ollama.ai/install.sh | sh
    ```
    
2. **Pull LLaMA 3.2 Model**
    
    ```bash
    ollama pull llama3.2:latest
    ```
    
3. **Install Python Dependencies**
    
    ```bash
    pip install flask requests
    ```
    

### Installation

1. **Clone the repository**
    
    ```bash
    git clone https://github.com/yourusername/owasp-ai-vulnerability-scanner.git
    cd owasp-ai-vulnerability-scanner
    ```
    
2. **Start Ollama service** (if not already running)
    
    ```bash
    ollama serve
    ```
    
3. **Run the application**
    
    ```bash
    python app.py
    ```
    
4. **Access the web interface**
    
    - Open your browser and navigate to `http://localhost:5000`
    - Health check: `http://localhost:5000/health`

## 🔧 Usage

### Web Interface

1. **Code Analysis**: Paste your source code directly into the text area
2. **URL Analysis**: Enter a URL to fetch and analyze web content
3. **View Results**: Get detailed vulnerability reports with OWASP mappings

### API Endpoints

#### Analyze Content

```bash
POST /analyze
Content-Type: application/json

{
  "type": "code",  // or "url"
  "content": "your code here or URL"
}
```

#### Health Check

```bash
GET /health
```

### Example API Usage

```python
import requests

# Analyze code
response = requests.post('http://localhost:5000/analyze', json={
    'type': 'code',
    'content': '''
    <?php
    $user_id = $_GET['id'];
    $query = "SELECT * FROM users WHERE id = " . $user_id;
    mysql_query($query);
    ?>
    '''
})

print(response.json())
```

## 📊 OWASP Top 10 2021 Coverage

The scanner analyzes for all OWASP Top 10 categories:

- **A01:2021** - Broken Access Control
- **A02:2021** - Cryptographic Failures
- **A03:2021** - Injection
- **A04:2021** - Insecure Design
- **A05:2021** - Security Misconfiguration
- **A06:2021** - Vulnerable and Outdated Components
- **A07:2021** - Identification and Authentication Failures
- **A08:2021** - Software and Data Integrity Failures
- **A09:2021** - Security Logging and Monitoring Failures
- **A10:2021** - Server-Side Request Forgery (SSRF)

## 🏗️ Architecture

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Web Browser   │───▶│   Flask App     │───▶│   Ollama API    │
│                 │    │                 │    │                 │
│ - Code Input    │    │ - Route Handler │    │ - LLaMA 3.2     │
│ - URL Input     │    │ - Content Fetch │    │ - AI Analysis   │
│ - Results View  │    │ - JSON Response │    │ - Vulnerability │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

## 🛠️ Configuration

### Ollama Settings

The application connects to Ollama at `http://localhost:11434` by default. To modify:

```python
class OWASPAnalyzer:
    def __init__(self):
        self.ollama_url = "http://your-ollama-host:11434/api/generate"
        self.model = "llama3.2:latest"  # or your preferred model
```

### Model Selection

Supported models (ensure they're pulled via Ollama):

- `llama3.2:latest` (recommended)
- `llama3.2:3b`
- `codellama:latest`
- `mistral:latest`

## 📝 Response Format

```json
{
  "vulnerabilities": [
    {
      "owasp_category": "A03:2021",
      "name": "SQL Injection",
      "location": "line 3",
      "risk_level": "Critical",
      "description": "Direct SQL query construction with user input",
      "remediation": "Use parameterized queries or prepared statements"
    }
  ],
  "summary": {
    "total_vulnerabilities": 1,
    "critical": 1,
    "high": 0,
    "medium": 0,
    "low": 0
  }
}
```

## 🤝 Contributing

Contributions are welcome! Please feel free to submit a Pull Request. For major changes, please open an issue first to discuss what you would like to change.

### Development Setup

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## 📄 License

This project is licensed under the MIT License - see the [LICENSE](https://claude.ai/chat/LICENSE) file for details.

## ⚠️ Disclaimer

This tool is for educational and security testing purposes only. Use it responsibly and only on systems you own or have explicit permission to test. The accuracy of vulnerability detection depends on the AI model and may produce false positives or miss certain vulnerabilities.

